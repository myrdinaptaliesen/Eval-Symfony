/*
4.3.4.1 Expression
*/

-- création de la table exemple
CREATE TABLE T_PERIODE
(PRD_CODE CHAR(1),
 PRD_1_DEBUT TIME,
 PRD_1_FIN   TIME,
 PRD_2_DEBUT TIME,
 PRD_2_FIN   TIME)

-- insertion des valeurs dans la table exemple
INSERT INTO T_PERIODE VALUES ('a', '08:00:00', '09:00:00', '08:30:00', '09:30:00')
INSERT INTO T_PERIODE VALUES ('b', '08:00:00', '09:00:00', '09:00:00', '09:30:00')
INSERT INTO T_PERIODE VALUES ('c', '09:00:00', '09:30:00', '09:00:00', '09:00:00')
INSERT INTO T_PERIODE VALUES ('d', '09:00:00', '09:30:00', '09:30:00', '09:30:00')
INSERT INTO T_PERIODE VALUES ('e', '08:00:00', '08:30:00', '09:00:00', '09:30:00')
INSERT INTO T_PERIODE VALUES ('f', '08:30:00', '09:00:00', '08:00:00', '08:30:00')
INSERT INTO T_PERIODE VALUES ('g', '08:30:00', '10:00:00', '08:00:00', '09:00:00')

/*
4.4.3.1 Expression de groupage 
*/

-- création de la table exemple
CREATE TABLE T_GROUPS_GRP 
(GRP_CHAR CHAR(1),
 GRP_NUM  INT,
 GRP_MONTANT DECIMAL(8,2))

-- insertion des valeurs dans la table exemple
INSERT INTO T_GROUPS_GRP VALUES ('A', 1, 0.12)
INSERT INTO T_GROUPS_GRP VALUES ('A', 1, 3.45)
INSERT INTO T_GROUPS_GRP VALUES ('B', 1, 6.78)
INSERT INTO T_GROUPS_GRP VALUES ('B', 1, 9.01)
INSERT INTO T_GROUPS_GRP VALUES ('A', 2, 2.34)
INSERT INTO T_GROUPS_GRP VALUES ('A', 2, 5.67)

-- création de la table exemple
CREATE TABLE T_FILM_FLM
(FLM_ID    INT NOT NULL PRIMARY KEY,
 FLM_TITRE VARCHAR(128),
 FLM_GENRE CHAR(8),
 FLM_ANNEE SMALLINT,
 USR_ID    INT)

-- insertion des valeurs dans la table exemple
INSERT INTO T_FILM_FLM VALUES (1,  'Docteur Jivago',               'Romance', 1960, 1)
INSERT INTO T_FILM_FLM VALUES (2,  'West side story',              'Musical', 1960, 1)
INSERT INTO T_FILM_FLM VALUES (3,  '2001 l''odyssée de l''espace', 'Fiction', 1961, 3)
INSERT INTO T_FILM_FLM VALUES (4,  'Planète interdite',            'Fiction', 1959, 2)
INSERT INTO T_FILM_FLM VALUES (5,  'ET',                           'Fiction', 1961, 3)
INSERT INTO T_FILM_FLM VALUES (6,  'Autant en emporte le vent',    'Romance', 1959, 2)
INSERT INTO T_FILM_FLM VALUES (7,  'All that Jazz',                'Musical', 1961, 2)
INSERT INTO T_FILM_FLM VALUES (8,  'My Fair Lady',                 'Musical', 1960, 1)
INSERT INTO T_FILM_FLM VALUES (9,  'Alien',                        'Fiction', 1961, 2)
INSERT INTO T_FILM_FLM VALUES (10, 'Le cinquième élément',         'Fiction', 1961, 3)
INSERT INTO T_FILM_FLM VALUES (11, 'Mars attack',                  'Fiction', 1961, 1)
INSERT INTO T_FILM_FLM VALUES (12, 'Blade runner',                 'Fiction', 1960, 3)
INSERT INTO T_FILM_FLM VALUES (13, 'Star trek',                    'Fiction', 1959, 2)
INSERT INTO T_FILM_FLM VALUES (14, 'Cats',                         'Musical', 1959, 3)
INSERT INTO T_FILM_FLM VALUES (15, 'Hair',                         'Musical', 1961, 3)
INSERT INTO T_FILM_FLM VALUES (16, 'Un américain à Paris',         'Musical', 1960, 1)
INSERT INTO T_FILM_FLM VALUES (17, 'Chantons sous la pluie',       'Musical', 1959, 1)
INSERT INTO T_FILM_FLM VALUES (18, 'Vacances romaine',             'Romance', 1960, 3)
INSERT INTO T_FILM_FLM VALUES (19, 'Love story',                   'Romance', 1960, 3)


/*
4.5 Constructeur de ligne valuée
*/

-- création de la table exemple
CREATE TABLE T_EVENEMENT_EVT 
(EVT_ID       INT NOT NULL PRIMARY KEY,
 EVT_MACHINE  VARCHAR(12),
 EVT_ANOMALIE VARCHAR(12),
 EVT_HEURE    INT,
 EVT_MINUTE   INT,
 EVT_SECONDE  INT)

-- insertion des valeurs dans la table exemple
INSERT INTO T_EVENEMENT_EVT VALUES (1, 'Réservoir', 'Vide', 11, 25, 18)
INSERT INTO T_EVENEMENT_EVT VALUES (2, 'Moteur', 'Surchauffe', 12, 10, 44)
INSERT INTO T_EVENEMENT_EVT VALUES (3, 'Pompe', 'Arrêt', 10, 55, 13)
INSERT INTO T_EVENEMENT_EVT VALUES (4, 'Moteur', 'Disjoncté', 11, 22, 33)

/*
Chapitre 4 exercice 15
*/

CREATE TABLE T_CHAMBRE_CHB
(CHB_ID       INTEGER    NOT NULL PRIMARY KEY,
 CHB_NUMERO   VARCHAR(3) NOT NULL,
 CHB_ETAGE    CHAR(3)    NOT NULL,
 CHB_COUCHAGE INTEGER    NOT NULL,
 CHB_CONFORT  VARCHAR(32)) 

INSERT INTO T_CHAMBRE_CHB VALUES (1,  '01', 'RDC', 2, 'Douche')
INSERT INTO T_CHAMBRE_CHB VALUES (2,  '02', 'RDC', 3, 'Bain')
INSERT INTO T_CHAMBRE_CHB VALUES (3,  '03', 'RDC', 4, 'Bain')
INSERT INTO T_CHAMBRE_CHB VALUES (4,  '10', '1er', 2, 'Douche')
INSERT INTO T_CHAMBRE_CHB VALUES (5,  '11', '1er', 3, 'Douche')
INSERT INTO T_CHAMBRE_CHB VALUES (6,  '12', '1er', 2, 'Bain')
INSERT INTO T_CHAMBRE_CHB VALUES (7,  '14', '1er', 3, 'Bain')
INSERT INTO T_CHAMBRE_CHB VALUES (8,  '20', '2e',  2, 'Douche')
INSERT INTO T_CHAMBRE_CHB VALUES (9,  '21', '2e',  3, 'Bain')
INSERT INTO T_CHAMBRE_CHB VALUES (10, '22', '2e',  5, 'Bains')

/*
Chapitre 4 exercice 17
*/

CREATE TABLE T_VENTE_CHAUSSURE_VCS
(VCS_DATE      DATE     NOT NULL,
 VCS_MODELE    CHAR(16) NOT NULL,
 VCS_TAILLE    INTEGER  NOT NULL,
 VCS_COULEUR   CHAR(10) NOT NULL,
 VCS_QUANTITE  INTEGER  NOT NULL)

INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-03', 'Nike Air 101', 44, 'Blanc', 2)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-04', 'Adidas Star', 45, 'Rouge', 3)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-04', 'Nike Air 101', 43, 'Blanc', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-04', 'Nike Air 101', 44, 'Blanc', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-03', 'Nike Air 101', 43, 'Noir', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-05', 'Nike Air 101', 43, 'Rouge', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-06', 'Adidas Star', 47, 'Bleu', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-05', 'Adidas Star', 44, 'Blanc', 3)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-05', 'Adidas Star', 45, 'Blanc', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-06', 'Nike Air 101', 43, 'Bleu', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-07', 'Adidas Star', 44, 'Noir', 3)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-08', 'Adidas Star', 45, 'Bleu', 3)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-07', 'Nike Air 101', 43, 'Bleu', 1)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-08', 'Adidas Star', 44, 'Blanc', 3)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-08', 'Adidas Star', 45, 'Bleu', 3)
INSERT INTO T_VENTE_CHAUSSURE_VCS VALUES ('2005-01-08', 'Nike Air 101', 43, 'Bleu', 2)

/*
Chapitre 4 exercice 20
*/

CREATE TABLE T_BELOTE_BLT
(BLT_JOUEUR  VARCHAR(8),
 BLT_MAIN    MULTISET VARCHAR(12))

INSERT INTO T_BELOTE_BLT VALUES ('Paul', MULTISET['Pique Roi',  'Coeur Valet',  'Trefle sept'])
INSERT INTO T_BELOTE_BLT VALUES ('Jean', MULTISET['Carreau As', 'Carreau huit', 'Trefle dix'])
INSERT INTO T_BELOTE_BLT VALUES ('Marc', MULTISET['Coeur Dame', 'Pique Dame',   'Trefle neuf'])
INSERT INTO T_BELOTE_BLT VALUES ('Jack', MULTISET['Coeur Roi',  'Pique dix,     'Pique Valet'])


/*
Chapitre 4 exercice 21
*/

CREATE TABLE T_MESURE_MSR
(MSR_MACHINE VARCHAR(8),
 MSR_MESURES INTEGER MULTISET)

INSERT INTO T_MESURE_MSR VALUES ('Pompe', MULTISET[47.25, 54.13, 78.43, 11.26, 119.12])
INSERT INTO T_MESURE_MSR VALUES ('Rotor', MULTISET[21.78, 45.96, 74.25, 23.21])
INSERT INTO T_MESURE_MSR VALUES ('Moteur', MULTISET[35.58, 47.98, 36.74, 41.9, 9.98, 11.28])


/*
5.1.2 jointure externe (LEFT, RIGHT, FULL OUTER JOIN)
*/

-- définition des tables
CREATE TABLE T_GAUCHE
(N INT,
 J CHAR(1))

CREATE TABLE T_DROITE 
(N INT,
 J CHAR(1))

-- valeurs insérées
INSERT INTO T_GAUCHE VALUES (1, 'A')
INSERT INTO T_GAUCHE VALUES (2, 'B')
INSERT INTO T_GAUCHE VALUES (3, 'D')
INSERT INTO T_GAUCHE VALUES (4, NULL)

INSERT INTO T_DROITE VALUES (10, 'A')
INSERT INTO T_DROITE VALUES (20, 'B')
INSERT INTO T_DROITE VALUES (30, 'C')
INSERT INTO T_DROITE VALUES (40, NULL)


/*
5.5.2 Une solution "force brute" (division relationnelle)
*/

-- la table T_RAYON_RYN recense les différents rayons du grand magasin
CREATE TABLE T_RAYON_RYN
(RYN_RAYON  CHAR(16))

-- la table T_ENTREPOT_ETP recense les différents entrepôts 
-- et les rayons desservi 
CREATE TABLE T_ENTREPOT_ETP
(ETP_VILLE  CHAR(16),
 RYN_RAYON  CHAR(16))

INSERT INTO T_RAYON_RYN (RYN_RAYON) VALUES ('frais')
INSERT INTO T_RAYON_RYN (RYN_RAYON) VALUES ('boisson')
INSERT INTO T_RAYON_RYN (RYN_RAYON) VALUES ('conserve')
INSERT INTO T_RAYON_RYN (RYN_RAYON) VALUES ('droguerie')

INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('PARIS', 'boisson')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('PARIS', 'frais')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('PARIS', 'conserve')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('PARIS', 'papeterie')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('LYON', 'boisson')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('LYON', 'droguerie')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('MARSEILLE', 'boisson')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('MARSEILLE', 'frais')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('MARSEILLE', 'conserve')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('MARSEILLE', 'droguerie')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('ANGER', 'droguerie')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('TOULOUSE', 'boisson')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('TOULOUSE', 'frais')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('TOULOUSE', 'conserve')
INSERT INTO T_ENTREPOT_ETP (ETP_VILLE, RYN_RAYON) 
       VALUES ('TOULOUSE', 'droguerie') 

/*
Chapitre 5 - Exercice 4 - jointure multiconditionnelle
*/

CREATE TABLE T_APPARTEMENT_APT
(APT_NUM      INTEGER NOT NULL PRIMARY KEY,
 APT_IMEUBLE  VARCHAR(16),
 APT_SURFACE  FLOAT,
 APT_ETAGE    INTEGER)

INSERT INTO T_APPARTEMENT_APT
       VALUES (1, 'Les Lilas', 150, 3)
INSERT INTO T_APPARTEMENT_APT
       VALUES (2, 'Les Lilas', 50, 4)
INSERT INTO T_APPARTEMENT_APT
       VALUES (3, 'Les Lilas', 200, 2)
INSERT INTO T_APPARTEMENT_APT
       VALUES (4, 'Les Lilas', 50, 5)
INSERT INTO T_APPARTEMENT_APT
       VALUES (5, 'Les Bleuets', 250, 1)
INSERT INTO T_APPARTEMENT_APT
       VALUES (6, 'Les Bleuets', 250, 2)

CREATE TABLE T_LOCATAIRE_LCT
(LCT_NUM      INTEGER NOT NULL PRIMARY KEY,
 APT_NUM      INTEGER,
 LCT_NOM      VARCHAR(16),
 LCT_PRENOM   VARCHAR(8))

INSERT INTO T_LOCATAIRE_LCT
       VALUES (101, 2, 'MARTIN', 'Michel')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (102, 3, 'MAUREL', 'Didier')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (103, 5, 'MEUNIER', 'Marie')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (104, 6, 'MONOD', 'Marcel')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (105, 6, 'MONOD', 'Jeannine')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (106, 1, 'MOULIN', 'Éric')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (107, 1, 'MOULIN', 'Martine')
INSERT INTO T_LOCATAIRE_LCT
       VALUES (108, 4, 'MEYER', 'Paul')

/*
Chapitre 5 - Exercice 19 - sous requête corrélée
*/

CREATE TABLE T_JOUEUR_JOR
(JOR_ID        INTEGER NOT NULL PRIMARY KEY,
 JOR_NOM       VARCHAR(16))

CREATE TABLE T_PARTIE_PTI
(PTI_ID        INTEGER NOT NULL PRIMARY KEY,
 PTI_DATEHEURE TIMESTAMP)

CREATE TABLE TJ_JOUE_JOE
(PTI_ID        INTEGER NOT NULL FOREIGN KEY REFERENCES T_PARTIE_PTI (PTI_ID),
 JOR_ID        INTEGER NOT NULL FOREIGN KEY REFERENCES T_JOUEUR_JOR (JOR_ID),
 CONSTRAINT    CK_PK_JPT PRIMARY KEY (PTI_ID, JOR_ID))

INSERT INTO T_JOUEUR_JOR VALUES (1, 'Paul')
INSERT INTO T_JOUEUR_JOR VALUES (2, 'Marcel')
INSERT INTO T_JOUEUR_JOR VALUES (3, 'Alain')
INSERT INTO T_JOUEUR_JOR VALUES (4, 'Jacques')
INSERT INTO T_JOUEUR_JOR VALUES (5, 'Eric')
INSERT INTO T_JOUEUR_JOR VALUES (6, 'Gérard')

INSERT INTO T_PARTIE_PTI VALUES (100, '2004-11-11 08:30')
INSERT INTO T_PARTIE_PTI VALUES (101, '2004-11-11 11:00')
INSERT INTO T_PARTIE_PTI VALUES (102, '2004-11-11 15:00')
INSERT INTO T_PARTIE_PTI VALUES (103, '2004-11-11 16:30')
INSERT INTO T_PARTIE_PTI VALUES (104, '2004-11-11 19:00')

INSERT INTO TJ_JOUE_JOE VALUES (100, 1)
INSERT INTO TJ_JOUE_JOE VALUES (100, 2)
INSERT INTO TJ_JOUE_JOE VALUES (101, 3)
INSERT INTO TJ_JOUE_JOE VALUES (101, 4)
INSERT INTO TJ_JOUE_JOE VALUES (102, 2)
INSERT INTO TJ_JOUE_JOE VALUES (103, 5)

/*
Chapitre 5 - Exercice 24 - statistiques
*/

CREATE TABLE T_JURY_JRY
(JRY_FILM        VARCHAR(25),
 JRY_HITCHCOCK   INTEGER,
 JRY_LANG        INTEGER,
 JRY_KUBRICK     INTEGER,
 JRY_WELLES      INTEGER)

INSERT INTO T_JURY_JRY
       VALUES ('West Side Story', 17, 15, NULL, 11)
INSERT INTO T_JURY_JRY
       VALUES ('Dr. Jivago', NULL, NULL, 13, 11)
INSERT INTO T_JURY_JRY
       VALUES ('Ben Hur', 15, 14, 8, 11)
INSERT INTO T_JURY_JRY
       VALUES ('My Fair Lady', 9, 10, 7, 13)
INSERT INTO T_JURY_JRY
       VALUES ('Scarface', 18, 18, 16, 17)

/*
Chapitre 5 - Exercice 25 - statistiques
*/


CREATE TABLE T_JURE_JUR
(JUR_ID INTEGER NOT NULL PRIMARY KEY,
 JUR_NOM VARCHAR(16))

CREATE TABLE T_FILM_FLM
(FLM_ID INTEGER NOT NULL PRIMARY KEY,
 FLM_NOM VARCHAR(16))

CREATE TABLE TJ_NOTE_NTE
(JUR_ID INTEGER NOT NULL,
 FLM_ID INTEGER NOT NULL,
 NTE_NOTE FLOAT NOT NULL,
 CONSTRAINT PK_NTE PRIMARY KEY (JUR_ID, FLM_ID),
 CONSTRAINT FK_NTE_JUR FOREIGN KEY (JUR_ID) REFERENCES T_JURE_JUR (JUR_ID),
 CONSTRAINT FK_NTE_FLM FOREIGN KEY (FLM_ID) REFERENCES T_FILM_FLM (FLM_ID))

INSERT INTO T_JURE_JUR VALUES (1, 'HITCHCOCK')
INSERT INTO T_JURE_JUR VALUES (2, 'LANG')
INSERT INTO T_JURE_JUR VALUES (3, 'KUBRICK')
INSERT INTO T_JURE_JUR VALUES (4, 'WELLES')

INSERT INTO T_FILM_FLM VALUES (11, 'West Side Story')
INSERT INTO T_FILM_FLM VALUES (12, 'Dr. Jivago')
INSERT INTO T_FILM_FLM VALUES (13, 'Ben Hur') 
INSERT INTO T_FILM_FLM VALUES (14, 'My Fair Lady')
INSERT INTO T_FILM_FLM VALUES (15, 'Scarface')

INSERT INTO TJ_NOTE_NTE VALUES (1, 11, 17)
INSERT INTO TJ_NOTE_NTE VALUES (1, 13, 15)
INSERT INTO TJ_NOTE_NTE VALUES (1, 14, 9)
INSERT INTO TJ_NOTE_NTE VALUES (1, 15, 18)

INSERT INTO TJ_NOTE_NTE VALUES (2, 11, 15)
INSERT INTO TJ_NOTE_NTE VALUES (2, 13, 14)
INSERT INTO TJ_NOTE_NTE VALUES (2, 14, 10)
INSERT INTO TJ_NOTE_NTE VALUES (2, 15, 18)

INSERT INTO TJ_NOTE_NTE VALUES (3, 12, 13)
INSERT INTO TJ_NOTE_NTE VALUES (3, 13, 8)
INSERT INTO TJ_NOTE_NTE VALUES (3, 14, 7)
INSERT INTO TJ_NOTE_NTE VALUES (3, 15, 16)

INSERT INTO TJ_NOTE_NTE VALUES (4, 11, 11)
INSERT INTO TJ_NOTE_NTE VALUES (4, 12, 11)
INSERT INTO TJ_NOTE_NTE VALUES (4, 13, 11)
INSERT INTO TJ_NOTE_NTE VALUES (4, 14, 13)
INSERT INTO TJ_NOTE_NTE VALUES (4, 15, 17)

/*
Chapitre 5 : Exercice 27 - sous requêtes corrélées
*/

ALTER TABLE T_PARTIE_PTI
ADD COLUMN PTI_DATEHEURE_FIN TIMESTAMP

UPDATE T_PARTIE_PTI
SET PTI_DATEHEURE_FIN = PTI_DATEHEURE + 3 HOUR

/*
Chapitre 5 : Exercice 28 - sous requêtes corrélées
*/

CREATE TABLE T_COURS_CRS
(CRS_ID       INTEGER NOT NULL PRIMARY KEY,
 CRS_ACTION   VARCHAR(12) NOT NULL,
 CRS_VALEUR   DECIMAL(8,2) NOT NULL,
 CRS_DEBUT    TIMESTAMP NOT NULL,
 CRS_FIN      TIMESTAMP NOT NULL,
 CONSTRAINT CK_DH_ORDRE CHECK (CRS_DEBUT < CRS_FIN))       

INSERT INTO T_COURS_CRS VALUES (1, 'IBM', 133.20, '2005-01-01 09:00', '2005-01-01 10:22')
INSERT INTO T_COURS_CRS VALUES (2, 'IBM', 133.20, '2005-01-01 11:33', '2005-01-01 16:15')
INSERT INTO T_COURS_CRS VALUES (5, 'IBM', 135.10, '2005-01-01 16:00', '2005-01-01 17:00')
INSERT INTO T_COURS_CRS VALUES (3, 'Air France', 1214.21, '2005-01-01 10:00', '2005-01-01 12:00')
INSERT INTO T_COURS_CRS VALUES (4, 'Air France', 1215.44, '2005-01-01 12:00', '2005-01-01 13:00')
INSERT INTO T_COURS_CRS VALUES (6, 'Air France', 1215.44, '2005-01-01 12:45', '2005-01-01 14:30')
INSERT INTO T_COURS_CRS VALUES (7, 'Air France', 1215.44, '2005-01-01 13:00', '2005-01-01 14:30')
INSERT INTO T_COURS_CRS VALUES (8, 'Air France', 1225.11, '2005-01-01 14:15', '2005-01-01 14:50')
INSERT INTO T_COURS_CRS VALUES (9, 'Air France', 1225.11, '2005-01-01 14:50', '2005-01-01 18:30')
INSERT INTO T_COURS_CRS VALUES (10, 'Air France', 1215.44, '2005-01-01 13:15', '2005-01-01 14:00')

/*
Chapitre 5 : Exercice 29 - graphe
*/

CREATE TABLE T_TRAJET_TRJ 
(TRJ_VILLE_DEPART  VARCHAR(32),
 TRJ_VILLE_ARRIVEE VARCHAR(32),
 TRJ_KILOMETRAGE   INTEGER)

INSERT INTO T_TRAJET_TRJ VALUES ('PARIS', 'NANTES', 385)
INSERT INTO T_TRAJET_TRJ VALUES ('PARIS', 'CLERMONT-FERRAND', 420)
INSERT INTO T_TRAJET_TRJ VALUES ('PARIS', 'LYON', 470)
INSERT INTO T_TRAJET_TRJ VALUES ('CLERMONT-FERRAND', 'MONTPELLIER', 335)
INSERT INTO T_TRAJET_TRJ VALUES ('CLERMONT-FERRAND', 'TOULOUSE', 375)
INSERT INTO T_TRAJET_TRJ VALUES ('LYON', 'MONTPELLIER', 305)
INSERT INTO T_TRAJET_TRJ VALUES ('LYON', 'MARSEILLE', 320)
INSERT INTO T_TRAJET_TRJ VALUES ('MONTPELLIER', 'TOULOUSE', 240)
INSERT INTO T_TRAJET_TRJ VALUES ('MARSEILLE', 'NICE', 205)

/*
Chapitre 5 : Exercice 31 - opérations ensemblistes
*/

CREATE TABLE T_VOITURE_LYON_VLN
(VLN_ID              INTEGER NOT NULL PRIMARY KEY,
 VLN_IMMATRICULATION VARCHAR(12) NOT NULL,
 VLN_MARQUE          CHAR(32),
 VLN_MODELE          CHAR(16),
 VLN_COULEUR         CHAR(16))

CREATE TABLE T_VOITURE_TOULOUSE_VTL
(VTL_PLAQUE          CHAR(16) NOT NULL PRIMARY KEY,
 VTL_MARQUE          VARCHAR(20),
 VTL_MODELE          VARCHAR(12),
 VTL_COULEUR         VARCHAR(8),
 VTL_CARBURANT       CHAR(2))

INSERT INTO T_VOITURE_LYON_VLN VALUES (78, '147 ACB 83', 'Volkswagen', 'Touran', 'Gris')
INSERT INTO T_VOITURE_LYON_VLN VALUES (87, '5147 XC 16', 'Volkswagen', 'Sharan', 'Blanc')
INSERT INTO T_VOITURE_LYON_VLN VALUES (99, '845 JCV 13', 'Volkswagen', 'Touran', 'Blanc')
INSERT INTO T_VOITURE_LYON_VLN VALUES (66, '458 ADR 83', 'Chrysler', 'PT Cruiser', 'Gris')
INSERT INTO T_VOITURE_LYON_VLN VALUES (59, '128 KLM 13', 'Renault', 'Megane', 'Blanc')
INSERT INTO T_VOITURE_LYON_VLN VALUES (69, '951 FGH 16', 'Renault', 'Clio', 'Blanc')

INSERT INTO T_VOITURE_TOULOUSE_VTL VALUES ('895 KDM 31', 'Renault', 'Megane', 'Gris', 'GO')
INSERT INTO T_VOITURE_TOULOUSE_VTL VALUES ('896 KDM 31', 'Renault', 'Megane', 'Blanc', 'ES')
INSERT INTO T_VOITURE_TOULOUSE_VTL VALUES ('894 KDM 31', 'Chrysler', 'PT Cruiser', 'Gris', 'ES')
INSERT INTO T_VOITURE_TOULOUSE_VTL VALUES ('963 JKD 31', 'Volkswagen', 'Touran', 'Noir', 'GO')
INSERT INTO T_VOITURE_TOULOUSE_VTL VALUES ('962 JKD 31', 'Volkswagen', 'Sharan', 'Blanc', 'GO')
INSERT INTO T_VOITURE_TOULOUSE_VTL VALUES ('5841 MN 12', 'Peugeot', '806', 'Vert', 'GO')


/*
Chapitre 5 : Exercice 35 - division relationnelle
*/

CREATE TABLE T_REALISATEUR_RLT
(RLT_ID     INTEGER NOT NULL PRIMARY KEY,
 RLT_NOM    VARCHAR(20))

CREATE TABLE T_ACTEUR_ACT
(ACT_ID     INTEGER NOT NULL PRIMARY KEY,
 ACT_NOM    VARCHAR(20),
 ACT_PRENOM VARCHAR(16),
 ACT_PAYS   VARCHAR(16))

CREATE TABLE T_FILM_FLM
(FLM_ID    INTEGER NOT NULL PRIMARY KEY,
 RLT_ID    INTEGER NOT NULL FOREIGN KEY 
              REFERENCES T_REALISATEUR_RLT(RLT_ID),
 FLM_TITRE VARCHAR(64),
 FLM_ANNEE SMALLINT,
 FLM_PAYS  VARCHAR(16))       

CREATE TABLE T_JOUE_JOU
(FLM_ID    INTEGER NOT NULL FOREIGN KEY 
              REFERENCES T_FILM_FLM (FLM_ID),
 ACT_ID    INTEGER NOT NULL FOREIGN KEY 
              REFERENCES T_ACTEUR_ACT (ACT_ID),
 CONSTRAINT PK_JOU PRIMARY KEY (ACT_ID, FLM_ID))


INSERT INTO T_REALISATEUR_RLT VALUES (1, 'HITCHCOCK')
INSERT INTO T_REALISATEUR_RLT VALUES (2, 'KUBRICK')
INSERT INTO T_REALISATEUR_RLT VALUES (3, 'CHABROL')

INSERT INTO T_FILM_FLM VALUES (1, 1, 'Fenêtre sur cour', 1954, 'USA')
INSERT INTO T_FILM_FLM VALUES (2, 1, 'Vertigo', 1958, 'USA')
INSERT INTO T_FILM_FLM VALUES (3, 1, 'L''homme qui en savait trop', 1956, 'USA')
INSERT INTO T_FILM_FLM VALUES (4, 1, 'La corde', 1948, 'USA')
INSERT INTO T_FILM_FLM VALUES (5, 2, 'Spartacus', 1960, 'USA')
INSERT INTO T_FILM_FLM VALUES (6, 2, 'Lolita', 1962, 'USA')
INSERT INTO T_FILM_FLM VALUES (7, 2, 'Dr Folamour', 1963, 'USA')
INSERT INTO T_FILM_FLM VALUES (8, 2, '2001 l''odyssée de l''espace', 1968, 'USA')
INSERT INTO T_FILM_FLM VALUES (9, 3, 'Le tigre aime la chair fraîche', 1964, 'France')
INSERT INTO T_FILM_FLM VALUES (10, 3, 'Marie Chantal contre le Docteur Kha', 1965, 'France')
INSERT INTO T_FILM_FLM VALUES (11, 3, 'La ligne de démarcation', 1966, 'France')
INSERT INTO T_FILM_FLM VALUES (12, 3, 'La route de Corinthe', 1967, 'France')
INSERT INTO T_FILM_FLM VALUES (13, 3, 'La femme infidèle', 1968, 'France')
INSERT INTO T_FILM_FLM VALUES (14, 3, 'Que la bête meure', 1969, 'France')

INSERT INTO T_ACTEUR_ACT VALUES (1, 'Hanin', 'Roger', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (2, 'Audran', 'Stéphane', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (3, 'Laforêt', 'Marie', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (4, 'Reggiani', 'Serge', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (5, 'Denner', 'Charles', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (6, 'Tamiroff', 'Akim', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (7, 'Chabrol', 'Claude', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (8, 'Bouquet', 'Michel', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (9, 'Ronet', 'Maurice', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (10, 'Seberg', 'Jean', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (11, 'Perrin', 'Jacques', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (12, 'Yanne', 'Jean', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (13, 'Gélin', 'Daniel', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (14, 'Perkins', 'Anthony', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (15, 'Trintignan', 'Jean-Louis', 'France')
INSERT INTO T_ACTEUR_ACT VALUES (16, 'Stewart', 'James', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (17, 'Kelly', 'Grace', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (18, 'Burr', 'Raymond', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (19, 'Day', 'Doris', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (20, 'Novak', 'Kim', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (21, 'Douglas', 'Kirk', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (22, 'Olivier', 'Laurence', 'GB')
INSERT INTO T_ACTEUR_ACT VALUES (23, 'Laughton', 'Charles', 'GB')
INSERT INTO T_ACTEUR_ACT VALUES (24, 'Ustinov', 'Peter', 'GB')
INSERT INTO T_ACTEUR_ACT VALUES (25, 'Curtis', 'Tony', 'USA')
INSERT INTO T_ACTEUR_ACT VALUES (26, 'Mason', 'James', 'GB')
INSERT INTO T_ACTEUR_ACT VALUES (27, 'Sellers', 'Peter', 'GB')
INSERT INTO T_ACTEUR_ACT VALUES (28, 'Scott', 'George C', 'USA')

INSERT INTO T_JOUE_JOU VALUES (1, 16)
INSERT INTO T_JOUE_JOU VALUES (1, 17)
INSERT INTO T_JOUE_JOU VALUES (1, 18)
INSERT INTO T_JOUE_JOU VALUES (2, 16)
INSERT INTO T_JOUE_JOU VALUES (2, 21)
INSERT INTO T_JOUE_JOU VALUES (3, 16)
INSERT INTO T_JOUE_JOU VALUES (3, 19)
INSERT INTO T_JOUE_JOU VALUES (4, 16)
INSERT INTO T_JOUE_JOU VALUES (5, 21)
INSERT INTO T_JOUE_JOU VALUES (5, 22)
INSERT INTO T_JOUE_JOU VALUES (5, 23)
INSERT INTO T_JOUE_JOU VALUES (5, 24)
INSERT INTO T_JOUE_JOU VALUES (5, 25)
INSERT INTO T_JOUE_JOU VALUES (6, 26)
INSERT INTO T_JOUE_JOU VALUES (6, 27)
INSERT INTO T_JOUE_JOU VALUES (7, 27)
INSERT INTO T_JOUE_JOU VALUES (7, 28)
INSERT INTO T_JOUE_JOU VALUES (9, 1)
INSERT INTO T_JOUE_JOU VALUES (9, 2)
INSERT INTO T_JOUE_JOU VALUES (10, 3)
INSERT INTO T_JOUE_JOU VALUES (10, 4)
INSERT INTO T_JOUE_JOU VALUES (10, 5)
INSERT INTO T_JOUE_JOU VALUES (10, 6)
INSERT INTO T_JOUE_JOU VALUES (10, 1)
INSERT INTO T_JOUE_JOU VALUES (10, 7)
INSERT INTO T_JOUE_JOU VALUES (11, 9)
INSERT INTO T_JOUE_JOU VALUES (11, 10)
INSERT INTO T_JOUE_JOU VALUES (11, 2)
INSERT INTO T_JOUE_JOU VALUES (11, 11)
INSERT INTO T_JOUE_JOU VALUES (11, 12)
INSERT INTO T_JOUE_JOU VALUES (12, 10)
INSERT INTO T_JOUE_JOU VALUES (12, 9)
INSERT INTO T_JOUE_JOU VALUES (12, 8)
INSERT INTO T_JOUE_JOU VALUES (12, 7)
INSERT INTO T_JOUE_JOU VALUES (13, 2)
INSERT INTO T_JOUE_JOU VALUES (13, 15)
INSERT INTO T_JOUE_JOU VALUES (13, 7)
INSERT INTO T_JOUE_JOU VALUES (14, 12)
